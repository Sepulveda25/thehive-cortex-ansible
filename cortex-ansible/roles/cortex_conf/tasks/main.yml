---

- name: Cambiar path analyzer en /etc/cortex/application.conf
  become: yes
  become_user: root
  replace:
    path: /etc/cortex/application.conf
    after: 'analyzer {'
    regexp: '(^|\s)path =($|\s).*' #matchea si empieza con un espacio en blanco y path..
    replace: |
             path =  [
                "{{path_default_analyzers }}",
                "{{path_my_own_analyzers }}"
             ]
	    

  
- name: fork-join executor Analyzer
  become: yes
  become_user: root
  replace:
    path: /etc/cortex/application.conf
    before: 'responder {'
    after: 'analyzer {'
    regexp: '(^|\s)fork-join-executor {'    
    replace: |    
	     fork-join executor {     
	     parallelism-min = 2       # Min number of threads available for analyze
             parallelism-factor = 2.0  # Parallelism (threads) ... ceil(available processors * factor)
             parallelism-max = 4       # Max number of threads available for analyze
             }
      




- name: Cambiar path responder en /etc/cortex/application.conf
  become: yes
  become_user: root
  replace:
    path: /etc/cortex/application.conf
    after: 'responder {'
    regexp: '(^|\s)path =($|\s).*' #matchea si empieza con un espacio en blanco y path..
    replace: |
             path =  [
                "{{path_default_responder }}",
                "{{path_my_own_responder }}"
             ]




- name: fork-join executor Responder
  become: yes
  become_user: root
  replace:
    path: /etc/cortex/application.conf
    before: 'parallelism-max =4'
    after: 'responder {'
    regexp: '(^|\s)fork-join-executor {'    
    replace: |    
             fork-join executor {
             parallelism-min = 2       # Min number of threads available for analyze
             parallelism-factor = 2.0  # Parallelism (threads) ... ceil(available processors * factor)
             parallelism-max = 4       # Max number of threads available for analyze
             }



